# سبق 21.2: خود مختار ہیومنائڈ کی تعمیر (اعلیٰ سطحی انٹیگریشن)

تفصیلات میں بیان کردہ مکمل خود مختار ہیومنائڈ کی تعمیر میں بڑی تعداد میں پیچیدہ اجزاء کو مربوط کرنا شامل ہے۔ یہ سبق اس بات پر توجہ مرکوز کرتا ہے کہ آپ ان ٹکڑوں کو اعلیٰ سطح پر کیسے جوڑیں گے۔

## 1. Isaac Sim میں سمیولیٹڈ ہیومنائڈ

*   **ماڈل:** Isaac Sim کے اثاثوں سے پہلے سے موجود ہیومنائڈ ماڈل استعمال کریں (مثلاً، کارٹر، فرینکا ایمیکا پانڈا ایک مربوط موبائل بیس کے ساتھ، یا اگر دستیاب ہو تو زیادہ پیچیدہ بائی پیڈل ہیومنائڈ)۔
*   **سینسرز:** Isaac Sim میں ماڈل کو ترتیب دیں تاکہ اس میں شامل ہوں:
    *   **RGB-D کیمرہ:** پرسیپشن کے لیے (آبجیکٹ ڈیٹیکشن، VSLAM)۔
    *   **IMU:** لوکلائزیشن اور توازن کے لیے۔
    *   **جوائنٹ اسٹیٹ پبلشرز:** کائیمیٹکس کے لیے جوائنٹ زاویے فراہم کرنے کے لیے۔
*   **ایکچوایٹرز:** روبوٹ کے جوڑوں کو ROS 2 ٹاپکس کے ذریعے کنٹرول کرنے کے لیے ترتیب دیں (مثلاً، `JointState` پیغامات یا اگر `ros_control` استعمال کر رہے ہوں تو براہ راست `JointController` ایکشن سرورز کو)۔

## 2. VLA پائپ لائن سیٹ اپ کرنا (وائس-ٹو-ایکشن)

### a. اسپیچ-ٹو-ٹیکسٹ نوڈ (`voice_command_node`)
*   **ان پٹ:** مائیکروفون آڈیو اسٹریم۔
*   **عمل:** آڈیو کو کلاؤڈ پر مبنی STT سروس (مثلاً، Google Speech-to-Text، OpenAI Whisper API) کو بھیجنے کے لیے `SpeechRecognition` جیسی لائبریری کے ساتھ ایک پائتھن نوڈ استعمال کریں۔
*   **آؤٹ پٹ:** `/voice_command_text` پر `std_msgs/msg/String` شائع کرتا ہے۔

### b. LLM پلانر نوڈ (`llm_planner_node`)
*   **ان پٹ:** `/voice_command_text` کو سبسکرائب کرتا ہے۔
*   **عمل:** دستیاب روبوٹ اعمال اور موجودہ ماحولیاتی سیاق و سباق کو شامل کرتے ہوئے ایک پرامپٹ تشکیل دیتا ہے۔ پرامپٹ کو ایک LLM API (مثلاً، OpenAI، Gemini) کو بھیجتا ہے۔ JSON جواب کو پارس کرتا ہے۔
*   **آؤٹ پٹ:** `/robot_plan` پر `std_msgs/msg/String` (JSON پلان پر مشتمل) شائع کرتا ہے۔

### c. ایکشن ایگزیکیوٹر نوڈ (`action_executor_node`)
*   **ان پٹ:** `/robot_plan` کو سبسکرائب کرتا ہے۔
*   **عمل:**
    *   **GOTO:** ایک `NavigateToPose` گول بناتا ہے اور اسے Nav2 ایکشن سرور (`/navigate_to_pose`) کو بھیجتا ہے۔
    *   **FIND:** آبجیکٹ کے نام کو پاس کرتے ہوئے پرسیپشن اسٹیک سے ایک کسٹم سروس `/find_object` کو کال کرتا ہے۔
    *   **PICKUP/DELIVER:** MoveIt2 کے لیے ایک `MoveGroupGoal` بناتا ہے (گریپر کے لیے ہدف پوز) اور اسے `/move_group` ایکشن سرور کو بھیجتا ہے۔
*   **آؤٹ پٹ:** مختلف ROS 2 ایکشن/سروس سرورز کو کالز کو منظم کرتا ہے۔

## 3. نیویگیشن اسٹیک

*   **Isaac ROS VSLAM نوڈ:** Isaac Sim سے سٹیریو کیمرہ اور IMU ڈیٹا کو سبسکرائب کرتا ہے (ROS 2 سے برج کیا گیا)۔ `/tf` (odom سے base_link) اور `/map` (پوائنٹ کلاؤڈ) شائع کرتا ہے۔
*   **Nav2 اسٹیک:** `amcl`، `global_planner`، `local_planner`، اور `controller_server` نوڈس لانچ کرتا ہے۔ لوکلائزیشن اور میپنگ کے لیے VSLAM آؤٹ پٹ استعمال کرنے کے لیے ترتیب دیا گیا ہے۔ `action_executor_node` سے گولز کو سبسکرائب کرتا ہے۔ روبوٹ کے بیس کنٹرولر کو `/cmd_vel` شائع کرتا ہے۔

## 4. پرسیپشن اسٹیک

*   **آبجیکٹ ڈیٹیکشن نوڈ:** Isaac Sim سے کیمرہ امیجز کو سبسکرائب کرتا ہے۔ GPU پر ایک پہلے سے تربیت یافتہ آبجیکٹ ڈیٹیکشن ماڈل (مثلاً، YOLO، EfficientDet) چلاتا ہے (ممکنہ طور پر Isaac ROS `detectnet_v2` کا استعمال کرتے ہوئے)۔
*   **`find_object` سروس:** پتہ لگائے گئے آبجیکٹ کے مقام کو استفسار کرنے کے لیے ایک سروس انٹرفیس فراہم کرتا ہے۔ جب کال کیا جاتا ہے، تو یہ مطلوبہ آبجیکٹ کے 3D پوز کو تلاش کرنے کے لیے آبجیکٹ ڈیٹیکشن ماڈل کے نتائج کا استعمال کرتا ہے۔

## 5. مینیپولیشن اسٹیک (MoveIt2)

*   **MoveIt2 نوڈس:** MoveIt سیٹ اپ اسسٹنٹ (باب 19 سے) آپ کے ہیومنائڈ بازو کے لیے کنفیگریشن تیار کرنے کے لیے استعمال ہوتا ہے۔ یہ `move_group`، `rviz`، اور دیگر ضروری نوڈس لانچ کرتا ہے۔
*   **`pickup_object` سروس:** یہ کسٹم سروس MoveIt2 کے ساتھ مربوط ہے۔ جب کال کیا جاتا ہے، تو یہ:
    1.  ہدف آبجیکٹ کے لیے ایک پری-گراس، گراس، اور پوسٹ-گراس پوز کا حساب لگاتا ہے۔
    2.  ان پوز کو `/move_group` ایکشن سرور کو گولز کے طور پر بھیجتا ہے۔
    3.  گریپر کو کھولنے/بند کرنے کا حکم دیتا ہے۔

## ماسٹر لانچ فائل کے ساتھ آرکیسٹریشن

پورا نظام ایک ہی کمانڈ سے لانچ ہونا چاہیے۔ اس میں ایک پیچیدہ پائتھن لانچ فائل شامل ہے (آپ کے ماڈیول 2 کیپسٹون کی طرح، لیکن بہت بڑی)۔

```python
# humanoid_vla_capstone.launch.py
from launch import LaunchDescription
from launch.actions import IncludeLaunchDescription, ExecuteProcess
from launch_ros.actions import Node
# ... Isaac Sim، Nav2، MoveIt2 کے لیے دیگر امپورٹس ...

def generate_launch_description():
    # 1. Isaac Sim لانچ کریں (ایک الگ پروسیس کے طور پر یا ایک Isaac Sim لانچ فائل شامل کریں)
    isaac_sim_launch = ExecuteProcess(...) # یا Isaac Sim کے لیے IncludeLaunchDescription

    # 2. نیویگیشن لانچ کریں (Nav2 Isaac ROS VSLAM کے ساتھ)
    nav2_launch = IncludeLaunchDescription(...) # ایک پہلے سے ترتیب شدہ Nav2 لانچ فائل استعمال کریں

    # 3. پرسیپشن لانچ کریں (آبجیکٹ ڈیٹیکشن نوڈ، find_object سروس)
    perception_launch = Node(...) # آپ کا آبجیکٹ ڈیٹیکشن نوڈ

    # 4. مینیپولیشن لانچ کریں (MoveIt2)
    moveit_launch = IncludeLaunchDescription(...) # آپ کے روبوٹ کی MoveIt2 لانچ فائل

    # 5. VLA پائپ لائن نوڈس لانچ کریں
    voice_command_node = Node(...)
    llm_planner_node = Node(...)
    action_executor_node = Node(...)

    return LaunchDescription([
        isaac_sim_launch,
        nav2_launch,
        perception_launch,
        moveit_launch,
        voice_command_node,
        llm_planner_node,
        action_executor_node,
    ])
```
یہ ایک اعلیٰ سطحی جائزہ ہے۔ ہر جزو بذات خود ایک پیچیدہ نظام ہے۔ اس کیپسٹون کا مقصد مکمل سسٹم فن تعمیر کو سمجھنا اور یہ سمجھنا ہے کہ یہ ٹکڑے ایک ساتھ کیسے فٹ ہوتے ہیں۔ آخری سبق میں، ہم ایسے پیچیدہ نظام کو جانچنے کا طریقہ پر تبادلہ خیال کریں گے۔

