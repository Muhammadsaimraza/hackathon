"use strict";(globalThis.webpackChunkrobolearn=globalThis.webpackChunkrobolearn||[]).push([[318],{7991:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"module-1-ros/communication/5-3-custom-interface","title":"Lesson 5.3: Custom Interfaces","description":"So far, we have used built-in message and service types like stdmsgs/msg/String and exampleinterfaces/srv/AddTwoInts. But for any real robot, you will need to define your own data structures. In ROS 2, these are called interfaces.","source":"@site/docs/module-1-ros/5-communication/5-3-custom-interface.md","sourceDirName":"module-1-ros/5-communication","slug":"/module-1-ros/communication/5-3-custom-interface","permalink":"/hackathon/docs/module-1-ros/communication/5-3-custom-interface","draft":false,"unlisted":false,"editUrl":"https://github.com/Muhammadsaimraza/docs/module-1-ros/5-communication/5-3-custom-interface.md","tags":[],"version":"current","frontMatter":{},"sidebar":"textbookSidebar","previous":{"title":"Lesson 5.2: Service Client","permalink":"/hackathon/docs/module-1-ros/communication/5-2-service-clients"},"next":{"title":"Lesson 5.4: Design Patterns (Topics vs. Services)","permalink":"/hackathon/docs/module-1-ros/communication/5-4-design-patterns"}}');var c=s(4848),o=s(8453);const i={},t="Lesson 5.3: Custom Interfaces",a={},d=[{value:"Creating an Interface Package",id:"creating-an-interface-package",level:2},{value:"Configuring the Build",id:"configuring-the-build",level:2},{value:"Using the Custom Interfaces",id:"using-the-custom-interfaces",level:2},{value:"Build and Run",id:"build-and-run",level:2}];function l(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"lesson-53-custom-interfaces",children:"Lesson 5.3: Custom Interfaces"})}),"\n",(0,c.jsxs)(n.p,{children:["So far, we have used built-in message and service types like ",(0,c.jsx)(n.code,{children:"std_msgs/msg/String"})," and ",(0,c.jsx)(n.code,{children:"example_interfaces/srv/AddTwoInts"}),". But for any real robot, you will need to define your own data structures. In ROS 2, these are called ",(0,c.jsx)(n.strong,{children:"interfaces"}),"."]}),"\n",(0,c.jsx)(n.p,{children:"There are three types of interfaces:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:".msg"}),": Message files, for topics."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:".srv"}),": Service files, for services."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:".action"}),": Action files, for long-running tasks (which we'll cover later)."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Let's create a package to hold our custom interfaces and then use them in our Python nodes."}),"\n",(0,c.jsx)(n.h2,{id:"creating-an-interface-package",children:"Creating an Interface Package"}),"\n",(0,c.jsx)(n.p,{children:"It is a best practice to keep your interface definitions in a separate package from the nodes that use them."}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Create Package:"})," In the ",(0,c.jsx)(n.code,{children:"src"})," directory of your workspace, create a new package."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 pkg create --build-type ament_cmake my_custom_interfaces\n"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Important:"})," Interface packages must be ",(0,c.jsx)(n.code,{children:"ament_cmake"})," packages, not ",(0,c.jsx)(n.code,{children:"ament_python"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Create Directories:"})," Inside the new package, create directories named ",(0,c.jsx)(n.code,{children:"msg"})," and ",(0,c.jsx)(n.code,{children:"srv"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd my_custom_interfaces\nmkdir msg\nmkdir srv\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsxs)(n.strong,{children:["Define a ",(0,c.jsx)(n.code,{children:".msg"})," file:"]})," Create a new file ",(0,c.jsx)(n.code,{children:"msg/Person.msg"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"# msg/Person.msg\nstring first_name\nstring last_name\nuint8 age\n"})}),"\n",(0,c.jsxs)(n.p,{children:["The format is simple: ",(0,c.jsx)(n.code,{children:"type name"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsxs)(n.strong,{children:["Define a ",(0,c.jsx)(n.code,{children:".srv"})," file:"]})," Create ",(0,c.jsx)(n.code,{children:"srv/SendPerson.srv"}),"."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"# srv/SendPerson.srv\nmy_custom_interfaces/msg/Person person_to_send\n---\nbool success\n"})}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"---"})," separates the request from the response. Here, the request is our custom ",(0,c.jsx)(n.code,{children:"Person"})," message, and the response is a simple boolean."]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"configuring-the-build",children:"Configuring the Build"}),"\n",(0,c.jsxs)(n.p,{children:["Because this is a ",(0,c.jsx)(n.code,{children:"ament_cmake"})," package, the build configuration is different from our Python package."]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsxs)(n.strong,{children:["Edit ",(0,c.jsx)(n.code,{children:"CMakeLists.txt"}),":"]})," You need to tell CMake to find the ROS 2 interface generation tools and then specify which files to build. Add these lines:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/Person.msg"\n  "srv/SendPerson.srv"\n)\n'})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsxs)(n.strong,{children:["Edit ",(0,c.jsx)(n.code,{children:"package.xml"}),":"]})," You need to add build dependencies."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-xml",children:"<build_depend>rosidl_default_generators</build_depend>\n<exec_depend>rosidl_default_runtime</exec_depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"using-the-custom-interfaces",children:"Using the Custom Interfaces"}),"\n",(0,c.jsx)(n.p,{children:"Now you can use these interfaces in your Python package."}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Add Dependency:"})," In your ",(0,c.jsx)(n.code,{children:"my_first_package/package.xml"}),", add a dependency on your new interface package."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-xml",children:"<depend>my_custom_interfaces</depend>\n"})}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Import and Use:"})," Now you can import ",(0,c.jsx)(n.code,{children:"Person"})," and ",(0,c.jsx)(n.code,{children:"SendPerson"})," just like any other message or service type."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# In your python node\nfrom my_custom_interfaces.msg import Person\nfrom my_custom_interfaces.srv import SendPerson\n\n# ...\n\n# Publishing a custom message\nperson_msg = Person()\nperson_msg.first_name = "John"\nperson_msg.last_name = "Doe"\nperson_msg.age = 30\nself.publisher_.publish(person_msg)\n\n# ...\n\n# Inside a service callback\n# request.person_to_send will be a Person object\nself.get_logger().info(f\'Received person: {request.person_to_send.first_name}\')\nresponse.success = True\nreturn response\n'})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"build-and-run",children:"Build and Run"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Build:"})," Go to your workspace root (",(0,c.jsx)(n.code,{children:"ros2_ws"}),") and run ",(0,c.jsx)(n.code,{children:"colcon build"}),". Colcon will be smart enough to build ",(0,c.jsx)(n.code,{children:"my_custom_interfaces"})," ",(0,c.jsx)(n.em,{children:"before"})," ",(0,c.jsx)(n.code,{children:"my_first_package"})," because of the dependency you added."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Source:"})," ",(0,c.jsx)(n.code,{children:"source install/setup.bash"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Verify:"})," You can now see your new types with the ",(0,c.jsx)(n.code,{children:"ros2 interface"})," command:","\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ros2 interface show my_custom_interfaces/msg/Person\nros2 interface show my_custom_interfaces/srv/SendPerson\n"})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Creating custom interfaces is a fundamental skill. It allows you to create clean, self-documenting APIs for all the nodes in your system. In the final lesson of this chapter, we'll discuss when to choose a topic versus a service for your API."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>t});var r=s(6540);const c={},o=r.createContext(c);function i(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);